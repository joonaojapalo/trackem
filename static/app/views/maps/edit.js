// Generated by CoffeeScript 1.10.0
(function() {
  define(["radio", "modelbinder", "marionette", "text!templates/maps/edit"], function(Radio, ModelBinder, Marionette, template) {
    var EditMapView, mapsChannel;
    mapsChannel = Radio.channel("maps");
    return EditMapView = Marionette.ItemView.extend({
      template: template,
      ui: {
        "save": '[data-action="save"]',
        "delete": '[data-action="delete"]',
        "mapName": 'input[name="name"]'
      },
      events: {
        "click @ui.save": "onClickSave",
        "click @ui.delete": "onClickDelete",
        "change @ui.mapName": "onChangeMapName"
      },
      onClickSave: function() {
        var promise, saveBtn;
        this.ui.save.prop("disabled", true);
        promise = this.model.save();
        saveBtn = this.ui.save;
        return promise.always(function() {
          return saveBtn.prop("disabled", false);
        });
      },
      onClickDelete: function() {
        var btn, promise;
        this.ui["delete"].prop("disabled", true);
        promise = this.model.destroy({
          wait: true
        });
        promise.done(function() {
          return mapsChannel.trigger("delete");
        });
        btn = this.ui["delete"];
        return promise.always(function() {
          return btn.prop("disabled", false);
        });
      },
      onChangeMapName: function() {
        this.model.set("name", this.ui.mapName.val());
        return console.debug("mapname change " + (this.model.get('name')));
      }
    });
  });

}).call(this);
