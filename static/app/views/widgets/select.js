// Generated by CoffeeScript 1.10.0
(function() {
  define(["underscore", "marionette", "app/translate"], function(_, Marionette, __) {
    var OptionView;
    OptionView = Marionette.ItemView.extend({
      tagName: "option",
      template: "{{text}}",
      templateHelpers: function() {
        return {
          text: this.model.get(this.nameAttr)
        };
      },
      initialize: function(options) {
        return this.mergeOptions(options, ["nameAttr", "valueAttr"]);
      },
      onRender: function() {
        return this.$el.attr("value", this.model.get(this.valueAttr));
      }
    });
    return Marionette.CollectionView.extend({
      tagName: "select",
      className: "form-control dropdown-toggle",
      childView: OptionView,
      childViewOptions: function() {
        return {
          valueAttr: this.valueAttr,
          nameAttr: this.nameAttr
        };
      },
      initialize: function(options) {
        _.bindAll(this, "findByValue", "onChange");
        this.mergeOptions(options, ["nameAttr", "valueAttr"]);
        return this.prefix = options.prefix || "select";
      },
      destroy: function() {
        return this.$el.off("change");
      },
      onRender: function() {
        this.$el.on("change", this.onChange);
        return this.$el.prepend('<option val="" selected="1" disabled="1">' + __("Select..") + '</option>');
      },
      onChange: function() {
        var eventName, model, value;
        value = this.$el.val();
        model = this.findByValue(parseInt(value));
        eventName = this.prefix + ":change";
        return this.trigger(eventName, model);
      },
      findByValue: function(value) {
        var query;
        query = {};
        query[this.valueAttr] = value;
        return this.collection.findWhere(query);
      }
    });
  });

}).call(this);
